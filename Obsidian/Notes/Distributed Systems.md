## 1 Introduction

这本书作者写于 2013 年，所以有些内容可能有点过时，有些新技术可能没有涉及。

分布式编程大部分时候都是在处理分布式以下的两个后果：
- 信息以光速传播
- 独立的事物会独立失败

本文分为五个章节，分别是基础知识、抽象层次、时间及顺序、复制：防止分歧、复制：接受分歧。

## 2 Distributed systems at a high level

分布式编程是使用多台计算机来解决可以在一台计算机上解决的同一问题的艺术。每台计算机上都要执行**存储**和**计算**两个基本任务。

### 2.1 Scalability

> 可拓展性是系统、网络或进程以有效的方式处理不断增长的工作量的能力，或者是扩大其规模以适应这种增长的能力。

- **规模可拓展性**：添加更多节点应该使系统线性更快​​；增加数据集不应增加延迟。
- **地理可拓展性**：应该可以使用多个数据中心来减少响应用户查询所需的时间，同时以某种合理的方式处理跨数据中心的延迟。
- **管理可拓展性**：添加更多节点不应增加系统的管理成本（例如管理员与机器的比率）。

### 2.2 Performance（latency）

> 性能是计算机系统完成的有用工作量与所使用的时间和资源的比较。可能会涉及：
> - 响应时间（延迟）
> - 高吞吐量
> - 计算资源利用率低

针对这些方面优化都需要权衡，例如，大批量可以实现高吞吐量，但是由于批处理，响应时间会更长。

### 2.3 Availability（fault tolerance）

> 可用性是系统处于正常运行状态的时间比例。如果用户无法访问系统，则称该系统不可用。分布式系统采用一堆不可靠的组件，并在它们之上构建一个**可靠**的系统。主要是通过**容错技术**来保证的。

### 2.4 限制

分布式系统受到两个物理因素的约束：
- 节点数量（随着所需存储和计算能力的增加而增加）
- 节点之间的距离（信息最多以光速传播）

独立节点数量的增加会增加系统发生故障的可能性（降低可用性并增加管理成本）；

独立节点数量的增加可能会增加节点之间通信的需求（随着规模的增加而降低性能）；

地理距离的增加会增加远程节点之间通信的最小延迟（降低某些操作的性能）。

### 2.5 Abstractions and models

抽象通过消除与解决问题无关的现实世界方面使事情更易于管理。模型以精确的方式描述分布式系统的关键属性。
- 系统模型（异步、同步）
- 故障模型（崩溃-故障、分区、拜占庭）
- 一致性模型（强一致性、最终一致性）

### 2.6 Design techniques：partition and replicate

抽象通过消除与解决问题无关的现实世界方面使事情更易于管理。模型以精确的方式描述分布式系统的关键属性。有两种可应用于数据集的基本技术。它可以分为多个节点（**分区**）以允许更多并行处理。它还可以复制或缓存在不同的节点上，以减少客户端和服务器之间的距离并提高容错能力（**复制**）。

#### 2.6.1 分区

分区是将数据集划分为较小的不同独立集合以减少数据集增长的影响，因为每个分区都是数据的子集。通过限制要处理的数据量并将相关数据定位在同一分区中来提高性能。

#### 2.6.2 复制

复制是在多台机器上复制相同的数据；这允许更多的服务器参与计算。是抵抗延迟的主要方式。
- **提高性能**：通过在多台机器上复制相同的数据，允许更多的服务器参与计算，从而减少延迟。
- **增强可用性**：通过创建数据的多个副本，提高系统的可用性，并增加在节点失败前系统能容忍的节点数量。

复制也带来了新的挑战。
- **同步问题**：多个独立的副本需要保持一致性，确保数据在不同机器上同步。
- **一致性模型的选择**：一致性模型决定了如何保证数据的同步与一致性，并影响系统的可用性与延迟。

复制也是许多问题的来源，因为现在有数据的独立副本必须在多台机器上保持同步 - 这意味着确保复制遵循一致性模型。

一致性模型的选择至关重要：良好的一致性模型为程序员提供了干净的语义（换句话说，其保证的属性易于推理），并符合业务/设计目标，例如高可用性或强大的一致性。

Only one consistency model for replication - strong consistency - allows you to program as-if the underlying data was not replicated. Other consistency models expose some internals of the replication to the programmer. However, weaker consistency models can provide lower latency and higher availability - and are not necessarily harder to understand, just different.